{"idx":"46bf3fa1-a85c-42a5-8958-17e60438e092","name":"Get Covid19 Canada Data","NodeDescription":"<p>///t</p><p>Introduction</p><p>// required packages</p><p>// puppeteer, csv-writer, async-csv, xlsx, shim</p><p><br></p><p>F:\\Personal\\Virtual_Server\\PHPWeb\\jsscrapepuppeteer&gt;covid19canada.js</p><p>t///</p>","children":[{"idx":"MY9884cd80-2669-43d0-ae63-7cd028ff4696","name":"Visit the site","custparents":[{"idx":"MY726d78df-d3c4-4060-867f-7fec8c86ab58"},{"idx":"46bf3fa1-a85c-42a5-8958-17e60438e092"}],"children":[{"idx":"MYae2ef2e5-7785-4652-a619-79510bd76301","name":"Launch the browser and go to URL","custparents":[{"idx":"MY9884cd80-2669-43d0-ae63-7cd028ff4696"}],"children":[]},{"idx":"MY8be9f1e3-6289-4458-a3ce-a7122f3d803d","name":"select the length of the table","custparents":[{"idx":"MY9884cd80-2669-43d0-ae63-7cd028ff4696"}]},{"idx":"MY39cfab2b-164a-46eb-8e50-cbfe4be578f9","name":"Determine the total pages","custparents":[{"idx":"MY9884cd80-2669-43d0-ae63-7cd028ff4696"},{"idx":"MY9884cd80-2669-43d0-ae63-7cd028ff4696"},{"idx":"MY9884cd80-2669-43d0-ae63-7cd028ff4696"}],"children":[]}]},{"idx":"MY7e82fe2e-c5f9-47f0-b064-6ac36105a8e4","name":"Get data","custparents":[{"idx":"46bf3fa1-a85c-42a5-8958-17e60438e092"}],"children":[{"idx":"MYf92aa7f9-b582-4c8f-a3a2-63507eefd464","name":"Loop for each page","custparents":[{"idx":"MY7e82fe2e-c5f9-47f0-b064-6ac36105a8e4"}],"children":[{"idx":"MY4de150e5-8f5a-4afd-a132-224a231042bd","name":"substeps","custparents":[{"idx":"MYf92aa7f9-b582-4c8f-a3a2-63507eefd464"}],"children":[{"idx":"MY982ea62a-a992-45f1-8c56-b9028e99ac94","name":"To Next Page (if not the first page)","custparents":[{"idx":"MY4de150e5-8f5a-4afd-a132-224a231042bd"},{"idx":"MY4de150e5-8f5a-4afd-a132-224a231042bd"},{"idx":"MY4de150e5-8f5a-4afd-a132-224a231042bd"}]},{"idx":"MYaae1e0a9-bef6-458b-97d3-1e71adf0e0eb","name":"get data from the target table","custparents":[{"idx":"MY4de150e5-8f5a-4afd-a132-224a231042bd"},{"idx":"MY4de150e5-8f5a-4afd-a132-224a231042bd"},{"idx":"MY4de150e5-8f5a-4afd-a132-224a231042bd"}],"children":[],"NodeDescription":"<p>///t</p><div class=\"ql-code-block-container\" spellcheck=\"false\"><div class=\"ql-code-block\" data-language=\"plain\"><br></div><div class=\"ql-code-block\" data-language=\"plain\">// to pass parameter i into the page.evaluate()</div><div class=\"ql-code-block\" data-language=\"plain\">let data = await page.evaluate((i) =&gt; {</div><div class=\"ql-code-block\" data-language=\"plain\">  // do something...</div><div class=\"ql-code-block\">}, i)</div></div><p>t///</p><p>[_L]</p>","_substeps":{"idx":"MY2ff58169-cd24-46a4-b10c-bcfe708d8a10","name":"substeps","custparents":[{"idx":"MYaae1e0a9-bef6-458b-97d3-1e71adf0e0eb"}],"children":[{"idx":"MYb92de13e-5a90-4ab4-9f85-15469700491d","name":"get td elements","custparents":[{"idx":"MY2ff58169-cd24-46a4-b10c-bcfe708d8a10"}]},{"idx":"MY3dbacd54-9f76-4017-b411-8aa2ea79ab56","name":"Get data from td","custparents":[{"idx":"MY2ff58169-cd24-46a4-b10c-bcfe708d8a10"}],"children":[{"idx":"MY311ea29f-ee01-4395-8c54-e240766f70ed","name":"have innerText for most cells","custparents":[{"idx":"MY3dbacd54-9f76-4017-b411-8aa2ea79ab56"}]},{"idx":"MY3324a81e-0dad-4461-a777-7b5d1859289b","name":"Have href link for the 'source' cell","custparents":[{"idx":"MY3dbacd54-9f76-4017-b411-8aa2ea79ab56"}]}]}]}},{"idx":"MYd33ef47b-a4b2-4f32-b1b7-0e7b5f72b162","name":"return the result data array","custparents":[{"idx":"MY4de150e5-8f5a-4afd-a132-224a231042bd"}]},{"idx":"MYad628341-e884-46ee-bb3c-3ee0a42cf3a0","name":"makearrangeData() Arrange data (loop for each data element)","custparents":[{"idx":"MY4de150e5-8f5a-4afd-a132-224a231042bd"}],"children":[],"_substeps":{"idx":"MYa98818c9-4146-41f8-9a83-252f72cc0d97","name":"substeps","custparents":[{"idx":"MYad628341-e884-46ee-bb3c-3ee0a42cf3a0"}],"children":[{"idx":"MYf7e7375d-bbdb-4108-9d9d-2a0e823387c3","name":"determine header","custparents":[{"idx":"MYa98818c9-4146-41f8-9a83-252f72cc0d97"}]},{"idx":"MY367c685b-beaa-4c4c-acb2-02983c604d49","name":"strip quotes","custparents":[{"idx":"MYa98818c9-4146-41f8-9a83-252f72cc0d97"}]},{"idx":"MYd75b8725-0000-4174-bcf9-de93cd8069ba","name":"reformat date values","custparents":[{"idx":"MYa98818c9-4146-41f8-9a83-252f72cc0d97"}]},{"idx":"MY9392d943-b93b-4dbf-9e10-63337c32872d","name":"push to the result array","custparents":[{"idx":"MYa98818c9-4146-41f8-9a83-252f72cc0d97"}]},{"idx":"MY869d0cfe-218d-46eb-9568-9b031aadab9b","name":"Return arranged data","custparents":[{"idx":"MYa98818c9-4146-41f8-9a83-252f72cc0d97"}]}]}},{"idx":"MYbafd9f11-aa48-4f56-9d3f-1a3aea76c910","name":"save to csv","custparents":[{"idx":"MY4de150e5-8f5a-4afd-a132-224a231042bd"}]}]}]}]},{"idx":"MYa9ceba4a-77b1-4b94-9760-db8156499c55","name":"Convert to CSV","custparents":[{"idx":"46bf3fa1-a85c-42a5-8958-17e60438e092"}],"children":[{"idx":"MY4accaf30-b2f4-409e-a546-b880e02823bb","name":"convert to xlsx","custparents":[{"idx":"MYa9ceba4a-77b1-4b94-9760-db8156499c55"}]}]},{"idx":"MY3f90e687-9bf6-4245-b631-47eca5672eea","name":"Automation","custparents":[{"idx":"46bf3fa1-a85c-42a5-8958-17e60438e092"}],"children":[{"idx":"MYf44eb4f5-8660-410e-8f08-1186f8424156","name":"make a bat file","custparents":[{"idx":"MY3f90e687-9bf6-4245-b631-47eca5672eea"}]},{"idx":"MYe3346c5c-5392-47eb-a39a-4b5a4ba7f746","name":"auto run windows task","custparents":[{"idx":"MY3f90e687-9bf6-4245-b631-47eca5672eea"}]}]}]}